{"version":3,"file":"index.js","sources":["../src/cartReducer.ts","../src/useLocalStorage.ts","../src/index.tsx"],"sourcesContent":["export interface Item {\r\n  id: string;\r\n  price: number;\r\n  quantity?: number;\r\n  itemTotal?: number;\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface InitialState {\r\n  items: Item[];\r\n  isEmpty: boolean;\r\n  totalItems: number;\r\n  totalUniqueItems: number;\r\n  totalCost: number;\r\n}\r\n\r\nexport interface CartState extends InitialState {\r\n  addItem: (item: Item, quantity?: number) => void;\r\n  removeItem: (id: Item[\"id\"]) => void;\r\n  updateItem: (id: Item[\"id\"], item: object) => void;\r\n  updateItemQuantity: (id: Item[\"id\"], quantity: number) => void;\r\n  clearCart: () => void;\r\n  getItem: (id: Item[\"id\"]) => Item | undefined;\r\n  inCart: (id: Item[\"id\"]) => boolean;\r\n}\r\n\r\nexport type Actions =\r\n  | { type: \"ADD_ITEM\"; payload: { item: Item } }\r\n  | { type: \"REMOVE_ITEM\"; payload: { idToRemove: Item[\"id\"] } }\r\n  | {\r\n      type: \"UPDATE_ITEM\";\r\n      payload: { item: Item; idToUpdate: Item[\"id\"] };\r\n    }\r\n  | { type: \"CLEAR_CART\"; payload: { initialCartState: InitialState } };\r\n\r\nconst generateCartState = (\r\n  currentCartState: CartState,\r\n  items: Item[]\r\n): CartState => {\r\n  const totalUniqueItems = calculateUniqueItems(items);\r\n  const isEmpty = totalUniqueItems === 0;\r\n\r\n  return {\r\n    ...currentCartState,\r\n    items: calculateItemTotals(items),\r\n    totalItems: calculateTotalItems(items),\r\n    totalUniqueItems,\r\n    totalCost: calculateCartTotal(items),\r\n    isEmpty,\r\n  };\r\n};\r\n\r\nconst calculateItemTotals = (items: Item[]): Item[] => {\r\n  return items.map((item) => ({\r\n    ...item,\r\n    itemTotal: item.price * item.quantity!,\r\n  }));\r\n};\r\n\r\nconst calculateTotalItems = (items: Item[]): number =>\r\n  items.reduce((sum, item) => sum + item.quantity!, 0);\r\n\r\nconst calculateCartTotal = (items: Item[]): number =>\r\n  items.reduce((total, item) => total + item.quantity! * item.price, 0);\r\n\r\nconst calculateUniqueItems = (items: Item[]): number => items.length;\r\n\r\nexport const cartReducer = (\r\n  state: CartState,\r\n  action: Actions\r\n): CartState | InitialState => {\r\n  switch (action.type) {\r\n    case \"ADD_ITEM\": {\r\n      const items = [...state.items, action.payload.item];\r\n\r\n      return generateCartState(state, items);\r\n    }\r\n    case \"UPDATE_ITEM\": {\r\n      const items = state.items.map((item) => {\r\n        if (item.id !== action.payload.idToUpdate) return item;\r\n\r\n        return {\r\n          ...item,\r\n          ...action.payload.item,\r\n        };\r\n      });\r\n\r\n      return generateCartState(state, items);\r\n    }\r\n    case \"REMOVE_ITEM\": {\r\n      const items = state.items.filter(\r\n        (item) => item.id !== action.payload.idToRemove\r\n      );\r\n\r\n      return generateCartState(state, items);\r\n    }\r\n    case \"CLEAR_CART\":\r\n      return { ...action.payload.initialCartState };\r\n  }\r\n};\r\n","import { useState } from \"react\";\r\n\r\n// Credit: \"Easy to understand React Hook recipes by Gabe Ragland\"\r\n\r\nexport default function useLocalStorage<T>(key: string, initialValue: T) {\r\n  // State to store our value\r\n  // Pass initial state function to useState so logic is only executed once\r\n  const [storedValue, setStoredValue] = useState<T>(() => {\r\n    try {\r\n      // Get from local storage by key\r\n      const item = window.localStorage.getItem(key);\r\n      // Parse stored json or if none return initialValue\r\n      return item ? JSON.parse(item) : initialValue;\r\n    } catch (error) {\r\n      // If error also return initialValue\r\n      console.log(error);\r\n      return initialValue;\r\n    }\r\n  });\r\n\r\n  // Return a wrapped version of useState's setter function that ...\r\n  // ... persists the new value to localStorage.\r\n  const setValue = (value: T | ((val: T) => T)) => {\r\n    try {\r\n      // Allow value to be a function so we have same API as useState\r\n      const valueToStore =\r\n        value instanceof Function ? value(storedValue) : value;\r\n      // Save state\r\n      setStoredValue(valueToStore);\r\n      // Save to local storage\r\n      window.localStorage.setItem(key, JSON.stringify(valueToStore));\r\n    } catch (error) {\r\n      // A more advanced implementation would handle the error case\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  return [storedValue, setValue];\r\n}\r\n","import * as React from \"react\";\r\nimport { cartReducer, CartState, Item } from \"./cartReducer\";\r\nimport useLocalStorage from \"./useLocalStorage\";\r\n\r\nconst { createContext, useContext, useReducer, useEffect } = React;\r\n\r\nconst initialState: any = {\r\n  items: [],\r\n  isEmpty: true,\r\n  totalItems: 0,\r\n  totalUniqueItems: 0,\r\n  totalCost: 0,\r\n};\r\n\r\nconst CartContext = createContext<CartState | undefined>(initialState);\r\n\r\nexport const useCart = () => {\r\n  // This makes sure that the cart functions are always\r\n  const context = useContext(CartContext);\r\n  if (!context) throw new Error(\"Expected to be wrapped in a CartProvider\");\r\n  return context;\r\n};\r\n\r\nexport const CartProvider: React.FC<{\r\n  children: React.ReactNode;\r\n  storage?: any;\r\n}> = ({ children, storage = useLocalStorage }) => {\r\n  const [savedCart, saveCart] = storage(\r\n    \"react-use-cart\",\r\n    JSON.stringify({\r\n      ...initialState,\r\n    })\r\n  );\r\n\r\n  const [cartState, dispatchCartState] = useReducer(\r\n    cartReducer,\r\n    JSON.parse(savedCart)\r\n  );\r\n\r\n  useEffect(() => {\r\n    saveCart(JSON.stringify(cartState));\r\n  }, [cartState, saveCart]);\r\n\r\n  const addItem = (item: Item, quantity: number = 1): void => {\r\n    if (quantity < 1) return;\r\n\r\n    if (item.id === undefined)\r\n      throw new Error(`Item object must have an \"id\" property.`);\r\n\r\n    if (item.price === undefined)\r\n      throw new Error(`Item object must have a \"price\" property.`);\r\n\r\n    const currentItem = cartState.items.find((i) => i.id === item.id);\r\n\r\n    if (currentItem) {\r\n      const payload = {\r\n        item: { ...item, quantity: currentItem.quantity! + quantity },\r\n        idToUpdate: item.id,\r\n      };\r\n\r\n      dispatchCartState({\r\n        type: \"UPDATE_ITEM\",\r\n        payload,\r\n      });\r\n    } else {\r\n      const payload = { item: { ...item, quantity } };\r\n      dispatchCartState({ type: \"ADD_ITEM\", payload });\r\n    }\r\n  };\r\n\r\n  const removeItem = (id: Item[\"id\"]): void => {\r\n    dispatchCartState({ type: \"REMOVE_ITEM\", payload: { idToRemove: id } });\r\n  };\r\n\r\n  const updateItem = (id: Item[\"id\"], updates: object) => {\r\n    const currentItem = cartState.items.find((item) => item.id === id);\r\n\r\n    if (!currentItem) throw new Error(\"No Item with that id in Items array.\");\r\n\r\n    const item = { ...currentItem, ...updates };\r\n\r\n    dispatchCartState({\r\n      type: \"UPDATE_ITEM\",\r\n      payload: { item, idToUpdate: id },\r\n    });\r\n  };\r\n\r\n  const updateItemQuantity = (id: Item[\"id\"], quantity: number): void => {\r\n    if (quantity <= 0) {\r\n      dispatchCartState({ type: \"REMOVE_ITEM\", payload: { idToRemove: id } });\r\n      return;\r\n    }\r\n\r\n    const currentItem = cartState.items.find((item) => item.id === id);\r\n\r\n    if (!currentItem) throw new Error(\"No Item with that id in Items array.\");\r\n\r\n    const item = { ...currentItem, quantity };\r\n\r\n    dispatchCartState({\r\n      type: \"UPDATE_ITEM\",\r\n      payload: { item, idToUpdate: id },\r\n    });\r\n  };\r\n\r\n  const clearCart = (): void => {\r\n    const payload = { initialCartState: initialState };\r\n    dispatchCartState({ type: \"CLEAR_CART\", payload });\r\n  };\r\n\r\n  const getItem = (id: Item[\"id\"]): Item | undefined =>\r\n    cartState.items.find((item) => item.id === id);\r\n\r\n  const inCart = (id: Item[\"id\"]): boolean =>\r\n    cartState.items.some((item) => item.id === id);\r\n\r\n  return (\r\n    <CartContext.Provider\r\n      value={{\r\n        ...cartState,\r\n        addItem,\r\n        removeItem,\r\n        updateItem,\r\n        updateItemQuantity,\r\n        clearCart,\r\n        getItem,\r\n        inCart,\r\n      }}\r\n    >\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n};\r\n"],"names":["useState","React.createContext","React.useContext","React.useReducer","React.useEffect","React.createElement"],"mappings":"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"}